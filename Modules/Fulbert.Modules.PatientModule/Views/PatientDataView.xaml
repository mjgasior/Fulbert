<mvvm:BaseView x:Class="Fulbert.Modules.PatientModule.Views.PatientDataView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:prism="http://www.codeplex.com/prism"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
               
    xmlns:lex="http://wpflocalizeextension.codeplex.com"
      lex:LocalizeDictionary.DesignCulture="pl-PL"
      lex:ResxLocalizationProvider.DefaultAssembly="Fulbert.Presentation.Localization"
      lex:ResxLocalizationProvider.DefaultDictionary="Labels"
              
    xmlns:interaction="clr-namespace:Fulbert.Infrastructure.Concrete.Interactions;assembly=Fulbert.Infrastructure"
    xmlns:behavior="clr-namespace:Fulbert.Infrastructure.Concrete.Behaviors;assembly=Fulbert.Infrastructure"
    xmlns:mvvm="clr-namespace:Fulbert.Infrastructure.Concrete.Mvvm;assembly=Fulbert.Infrastructure"           
    mc:Ignorable="d" d:DesignHeight="300" d:DesignWidth="300">

    <i:Interaction.Triggers>
        <prism:InteractionRequestTrigger SourceObject="{Binding NotificationRequest, Mode=OneWay}">
            <prism:PopupWindowAction IsModal="True" CenterOverAssociatedObject="True" WindowStyle="{StaticResource windowInteractive}">
                <prism:PopupWindowAction.WindowContent>
                    <interaction:NotificationContent/>
                </prism:PopupWindowAction.WindowContent>
            </prism:PopupWindowAction>
        </prism:InteractionRequestTrigger>
    </i:Interaction.Triggers>
    
    <StackPanel>
        <Label Content="{lex:Loc PatientData}" Style="{StaticResource labelHeaderStyle}"/>

        <UniformGrid Columns="2" DataContext="{Binding PatientModel}">
            <Label Content="{lex:Loc FirstName}"/>
            <TextBox Text="{Binding Path=FirstName, Mode=TwoWay, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>

            <Label Content="{lex:Loc LastName}"/>
            <TextBox Text="{Binding LastName, ValidatesOnNotifyDataErrors=True}"/>

            <Label Content="{lex:Loc PeselNumber}"/>
            <TextBox Text="{Binding Path=Pesel, Mode=TwoWay, ValidatesOnDataErrors=True, 
                            NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource textBoxInError}" MaxLength="11">
                <i:Interaction.Behaviors>
                    <behavior:OnlyNumericInputBehavior/>
                </i:Interaction.Behaviors>
            </TextBox>

        </UniformGrid>

        <StackPanel Margin="5">
            <StackPanel.Resources>
                <DataTemplate DataType="{x:Type ValidationError}">
                    <TextBlock Text="{Binding ErrorContent}" Foreground="White" Background="Red" VerticalAlignment="Center" FontWeight="Bold"/>
                </DataTemplate>
            </StackPanel.Resources>
            <TextBox Name="TextBox1" Text="{Binding PatientModel.FirstName, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
            <ContentPresenter Content="{Binding ElementName=TextBox1, Path=(Validation.Errors).CurrentItem}" HorizontalAlignment="Left"/>

            <TextBox Name="TextBox2" Text="{Binding PatientModel.Pesel, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
            <ContentPresenter Content="{Binding ElementName= TextBox2, Path=(Validation.Errors).CurrentItem}" HorizontalAlignment="Left"/>
            
        </StackPanel>

        <Button Command="{Binding SavePatientDataCommand}" Margin="10" Content="{lex:Loc SavePatientData}"/>
        <Button Command="{Binding AddAppointmentCommand}" Margin="10" Content="{lex:Loc AddAppointment}" 
                Visibility="{Binding IsEditMode, Converter={StaticResource BoolToVisibleConverter}}"/>
    </StackPanel>
</mvvm:BaseView>